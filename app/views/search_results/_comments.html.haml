- source = local_assigns[:source]
- commentable = local_assigns[:commentable]
- path_scope = local_assigns[:path_scope]
- comments = commentable.comments

- if comments.blank?
  - if logged_in?
    = render :partial => "search_results/comment_form",
      :locals => {:source => source,
        :commentable => commentable,
        :path_scope => path_scope}
  - else
    %p= t("answers.form.not_logged", :link => new_user_session_path) 
- else

  = render :partial => "comments/comment", :object => comments[0], :locals => {:source => source, :mini => true}
  - comments = comments[1 .. comments.count]
  - if comments.blank?
    - if logged_in?
      = render :partial => 'comments/count', :locals => {:message => "ADICIONAR MENSAGEM"}
    - else
      %p= t("answers.form.not_logged", :link => new_user_session_path) 
  - else
    = render :partial => 'comments/count', :locals => {:count => comments.count}
  .comments_wrapper
    .comments
      - comments.each do |comment|
        = render :partial => "comments/comment", :object => comment, :locals => {:source => source, :mini => true}
    - if logged_in?
      .forms
        - @comment = Comment.new
        = form_tag(url_for(path_scope + [@comment]) + ".js",
          :class => "form commentForm",
          :remote => true, "data-type" => "json") do
          = render :partial => "comments/form",
            :locals => {:source => source,
                        :commentable => commentable}
          .group.navform
            = submit_tag t("comments.shared.comment_submit"), :class => "button"
